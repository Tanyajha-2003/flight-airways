{"ast":null,"code":"// import React, { useState, useEffect } from 'react';\n// import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\n// import axios from 'axios';\n// import { Toaster, toast } from 'react-hot-toast';\n// import Navbar from './components/Navbar';\n// import FlightSearch from './components/FlightSearch';\n// import FlightList from './components/FlightList';\n// import BookingForm from './components/BookingForm';\n// import Wallet from './components/Wallet';\n// import BookingHistory from './components/BookingHistory';\n// import './styles/purple-theme.css';\n\n// const App = () => {\n//   // const [user, setUser] = useState({\n//   //   id: 'user_001',\n//   //   name: 'John Doe',\n//   //   email: 'john@example.com',\n//   //   walletBalance: 50000\n//   // });\n//   const [user, setUser] = useState(null);\n// if (!user) {\n//   return <div className=\"text-center mt-20 text-purple-600\">Loading user...</div>;\n// }\n\n// useEffect(() => {\n//   const initUser = async () => {\n//     const saved = localStorage.getItem('flightUser');\n//     if (saved) {\n//       setUser(JSON.parse(saved));\n//       return;\n//     }\n\n//     const res = await axios.post('http://localhost:5001/api/users/init', {\n//       name: 'John Doe',\n//       email: 'john@example.com'\n//     });\n\n//     const newUser = {\n//       id: res.data._id,\n//       name: res.data.name,\n//       email: res.data.email,\n//       walletBalance: res.data.wallet_balance\n//     };\n\n//     localStorage.setItem('flightUser', JSON.stringify(newUser));\n//     setUser(newUser);\n//   };\n\n//   initUser();\n// }, []);\n\n//   const [flights, setFlights] = useState([]);\n//   const [selectedFlight, setSelectedFlight] = useState(null);\n//   const [bookings, setBookings] = useState([]);\n\n//   // Mock user authentication\n//   useEffect(() => {\n//     // In a real app, this would be from localStorage or API\n//     const savedUser = localStorage.getItem('flightUser');\n//     if (savedUser) {\n//       setUser(JSON.parse(savedUser));\n//     }\n//   }, []);\n\n//   // Fetch bookings on load\n//   useEffect(() => {\n//     fetchBookings();\n//   }, [user.id]);\n\n//   const fetchBookings = async () => {\n//     try {\n//       const response = await axios.get(`http://localhost:5001/api/bookings/user/${user.id}`);\n//       setBookings(response.data);\n//     } catch (error) {\n//       console.error('Error fetching bookings:', error);\n//     }\n//   };\n\n//   const handleSearchFlights = async (searchParams) => {\n//     try {\n//       const response = await axios.get('http://localhost:5001/api/flights/search', {\n//         params: searchParams\n//       });\n//       setFlights(response.data);\n//       toast.success(`Found ${response.data.length} flights`);\n//     } catch (error) {\n//       toast.error('Error searching flights');\n//     }\n//   };\n\n//   const handleBookingAttempt = async (flightId) => {\n//     try {\n//       const response = await axios.post(`http://localhost:5001/api/flights/${flightId}/attempt`, {\n//         userId: user.id\n//       });\n\n//       // Update flight price locally\n//       setFlights(flights.map(flight => \n//         flight.flight_id === flightId \n//           ? { ...flight, current_price: response.data.current_price }\n//           : flight\n//       ));\n\n//       if (response.data.surge_active) {\n//         toast.error('⚠️ Price increased due to high demand!', {\n//           duration: 4000,\n//           icon: '⚠️'\n//         });\n//       }\n\n//       return response.data;\n//     } catch (error) {\n//       console.error('Booking attempt failed:', error);\n//       return null;\n//     }\n//   };\n\n//   const handleBookFlight = async (flightId, passengerInfo) => {\n//     try {\n//       const response = await axios.post('http://localhost:5001/api/bookings', {\n//         userId: user.id,\n//         flightId,\n//         passengerInfo\n//       });\n\n//       if (response.data.success) {\n//         // Update user wallet\n//         setUser(prev => ({\n//           ...prev,\n//           walletBalance: response.data.new_balance\n//         }));\n\n//         // Save to localStorage\n//         localStorage.setItem('flightUser', JSON.stringify({\n//           ...user,\n//           walletBalance: response.data.new_balance\n//         }));\n\n//         // Add to bookings\n//         setBookings(prev => [response.data.booking, ...prev]);\n\n//         toast.success('Booking successful! Downloading ticket...');\n\n//         // Download ticket\n//         setTimeout(() => {\n//           window.open(`http://localhost:5001/api/bookings/ticket/${response.data.booking.pnr}`, '_blank');\n//         }, 1000);\n\n//         return true;\n//       }\n//     } catch (error) {\n//       if (error.response?.data?.error === 'Insufficient wallet balance') {\n//         toast.error(`Insufficient balance. Required: ₹${error.response.data.required}, Available: ₹${error.response.data.available}`);\n//       } else {\n//         toast.error('Booking failed');\n//       }\n//       return false;\n//     }\n//   };\n\n//   const handleAddFunds = async (amount) => {\n//     try {\n//       const response = await axios.post(`http://localhost:5001/api/wallet/${user.id}/add`, {\n//         amount\n//       });\n\n//       if (response.data.success) {\n//         setUser(prev => ({\n//           ...prev,\n//           walletBalance: response.data.new_balance\n//         }));\n\n//         localStorage.setItem('flightUser', JSON.stringify({\n//           ...user,\n//           walletBalance: response.data.new_balance\n//         }));\n\n//         toast.success(`Added ₹${amount} to wallet`);\n//         return true;\n//       }\n//     } catch (error) {\n//       toast.error('Failed to add funds');\n//       return false;\n//     }\n//   };\n\n//   return (\n//     <Router>\n//       <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50\">\n//         <Toaster \n//           position=\"top-right\"\n//           toastOptions={{\n//             style: {\n//               background: '#6B46C1',\n//               color: '#fff',\n//             },\n//           }}\n//         />\n\n//         <Navbar user={user} />\n\n//         <div className=\"container mx-auto px-4 py-8\">\n//           <Routes>\n//             <Route path=\"/\" element={\n//               <div className=\"fade-in\">\n//                 <div className=\"text-center mb-12\">\n//                   <h1 className=\"text-4xl font-bold text-purple-900 mb-4\">\n//                     ✈️ Find Your Perfect Flight\n//                   </h1>\n//                   <p className=\"text-purple-600 text-lg\">\n//                     Book flights with dynamic pricing and exclusive deals\n//                   </p>\n//                 </div>\n\n//                 <FlightSearch onSearch={handleSearchFlights} />\n\n//                 {flights.length > 0 && (\n//                   <FlightList \n//                     flights={flights} \n//                     onSelectFlight={setSelectedFlight}\n//                     onBookingAttempt={handleBookingAttempt}\n//                   />\n//                 )}\n//               </div>\n//             } />\n\n//             <Route path=\"/book\" element={\n//               selectedFlight ? (\n//                 <BookingForm \n//                   flight={selectedFlight}\n//                   user={user}\n//                   onBook={handleBookFlight}\n//                 />\n//               ) : (\n//                 <Navigate to=\"/\" />\n//               )\n//             } />\n\n//             <Route path=\"/wallet\" element={\n//               <Wallet \n//                 user={user}\n//                 onAddFunds={handleAddFunds}\n//               />\n//             } />\n\n//             <Route path=\"/history\" element={\n//               <BookingHistory \n//                 bookings={bookings}\n//                 onDownloadTicket={(pnr) => {\n//                   window.open(`http://localhost:5001/api/bookings/ticket/${pnr}`, '_blank');\n//                 }}\n//               />\n//             } />\n//           </Routes>\n//         </div>\n\n//         <footer className=\"bg-purple-900 text-white py-8 mt-12\">\n//           <div className=\"container mx-auto px-4 text-center\">\n//             <p className=\"text-purple-200\">© 2024 Flight Booking System. All rights reserved.</p>\n//             <p className=\"text-purple-300 mt-2\">Built with ❤️ using MERN Stack</p>\n//           </div>\n//         </footer>\n//       </div>\n//     </Router>\n//   );\n// };\n\n// export default App;","map":{"version":3,"names":[],"sources":["/Users/tanyakumari/Desktop/flight-booking-app/frontend/src/App.js"],"sourcesContent":["// import React, { useState, useEffect } from 'react';\n// import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\n// import axios from 'axios';\n// import { Toaster, toast } from 'react-hot-toast';\n// import Navbar from './components/Navbar';\n// import FlightSearch from './components/FlightSearch';\n// import FlightList from './components/FlightList';\n// import BookingForm from './components/BookingForm';\n// import Wallet from './components/Wallet';\n// import BookingHistory from './components/BookingHistory';\n// import './styles/purple-theme.css';\n\n// const App = () => {\n//   // const [user, setUser] = useState({\n//   //   id: 'user_001',\n//   //   name: 'John Doe',\n//   //   email: 'john@example.com',\n//   //   walletBalance: 50000\n//   // });\n//   const [user, setUser] = useState(null);\n// if (!user) {\n//   return <div className=\"text-center mt-20 text-purple-600\">Loading user...</div>;\n// }\n\n// useEffect(() => {\n//   const initUser = async () => {\n//     const saved = localStorage.getItem('flightUser');\n//     if (saved) {\n//       setUser(JSON.parse(saved));\n//       return;\n//     }\n\n//     const res = await axios.post('http://localhost:5001/api/users/init', {\n//       name: 'John Doe',\n//       email: 'john@example.com'\n//     });\n\n//     const newUser = {\n//       id: res.data._id,\n//       name: res.data.name,\n//       email: res.data.email,\n//       walletBalance: res.data.wallet_balance\n//     };\n\n//     localStorage.setItem('flightUser', JSON.stringify(newUser));\n//     setUser(newUser);\n//   };\n\n//   initUser();\n// }, []);\n\n//   const [flights, setFlights] = useState([]);\n//   const [selectedFlight, setSelectedFlight] = useState(null);\n//   const [bookings, setBookings] = useState([]);\n  \n//   // Mock user authentication\n//   useEffect(() => {\n//     // In a real app, this would be from localStorage or API\n//     const savedUser = localStorage.getItem('flightUser');\n//     if (savedUser) {\n//       setUser(JSON.parse(savedUser));\n//     }\n//   }, []);\n  \n//   // Fetch bookings on load\n//   useEffect(() => {\n//     fetchBookings();\n//   }, [user.id]);\n  \n//   const fetchBookings = async () => {\n//     try {\n//       const response = await axios.get(`http://localhost:5001/api/bookings/user/${user.id}`);\n//       setBookings(response.data);\n//     } catch (error) {\n//       console.error('Error fetching bookings:', error);\n//     }\n//   };\n  \n//   const handleSearchFlights = async (searchParams) => {\n//     try {\n//       const response = await axios.get('http://localhost:5001/api/flights/search', {\n//         params: searchParams\n//       });\n//       setFlights(response.data);\n//       toast.success(`Found ${response.data.length} flights`);\n//     } catch (error) {\n//       toast.error('Error searching flights');\n//     }\n//   };\n  \n//   const handleBookingAttempt = async (flightId) => {\n//     try {\n//       const response = await axios.post(`http://localhost:5001/api/flights/${flightId}/attempt`, {\n//         userId: user.id\n//       });\n      \n//       // Update flight price locally\n//       setFlights(flights.map(flight => \n//         flight.flight_id === flightId \n//           ? { ...flight, current_price: response.data.current_price }\n//           : flight\n//       ));\n      \n//       if (response.data.surge_active) {\n//         toast.error('⚠️ Price increased due to high demand!', {\n//           duration: 4000,\n//           icon: '⚠️'\n//         });\n//       }\n      \n//       return response.data;\n//     } catch (error) {\n//       console.error('Booking attempt failed:', error);\n//       return null;\n//     }\n//   };\n  \n//   const handleBookFlight = async (flightId, passengerInfo) => {\n//     try {\n//       const response = await axios.post('http://localhost:5001/api/bookings', {\n//         userId: user.id,\n//         flightId,\n//         passengerInfo\n//       });\n      \n//       if (response.data.success) {\n//         // Update user wallet\n//         setUser(prev => ({\n//           ...prev,\n//           walletBalance: response.data.new_balance\n//         }));\n        \n//         // Save to localStorage\n//         localStorage.setItem('flightUser', JSON.stringify({\n//           ...user,\n//           walletBalance: response.data.new_balance\n//         }));\n        \n//         // Add to bookings\n//         setBookings(prev => [response.data.booking, ...prev]);\n        \n//         toast.success('Booking successful! Downloading ticket...');\n        \n//         // Download ticket\n//         setTimeout(() => {\n//           window.open(`http://localhost:5001/api/bookings/ticket/${response.data.booking.pnr}`, '_blank');\n//         }, 1000);\n        \n//         return true;\n//       }\n//     } catch (error) {\n//       if (error.response?.data?.error === 'Insufficient wallet balance') {\n//         toast.error(`Insufficient balance. Required: ₹${error.response.data.required}, Available: ₹${error.response.data.available}`);\n//       } else {\n//         toast.error('Booking failed');\n//       }\n//       return false;\n//     }\n//   };\n  \n//   const handleAddFunds = async (amount) => {\n//     try {\n//       const response = await axios.post(`http://localhost:5001/api/wallet/${user.id}/add`, {\n//         amount\n//       });\n      \n//       if (response.data.success) {\n//         setUser(prev => ({\n//           ...prev,\n//           walletBalance: response.data.new_balance\n//         }));\n        \n//         localStorage.setItem('flightUser', JSON.stringify({\n//           ...user,\n//           walletBalance: response.data.new_balance\n//         }));\n        \n//         toast.success(`Added ₹${amount} to wallet`);\n//         return true;\n//       }\n//     } catch (error) {\n//       toast.error('Failed to add funds');\n//       return false;\n//     }\n//   };\n  \n//   return (\n//     <Router>\n//       <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50\">\n//         <Toaster \n//           position=\"top-right\"\n//           toastOptions={{\n//             style: {\n//               background: '#6B46C1',\n//               color: '#fff',\n//             },\n//           }}\n//         />\n        \n//         <Navbar user={user} />\n        \n//         <div className=\"container mx-auto px-4 py-8\">\n//           <Routes>\n//             <Route path=\"/\" element={\n//               <div className=\"fade-in\">\n//                 <div className=\"text-center mb-12\">\n//                   <h1 className=\"text-4xl font-bold text-purple-900 mb-4\">\n//                     ✈️ Find Your Perfect Flight\n//                   </h1>\n//                   <p className=\"text-purple-600 text-lg\">\n//                     Book flights with dynamic pricing and exclusive deals\n//                   </p>\n//                 </div>\n                \n//                 <FlightSearch onSearch={handleSearchFlights} />\n                \n//                 {flights.length > 0 && (\n//                   <FlightList \n//                     flights={flights} \n//                     onSelectFlight={setSelectedFlight}\n//                     onBookingAttempt={handleBookingAttempt}\n//                   />\n//                 )}\n//               </div>\n//             } />\n            \n//             <Route path=\"/book\" element={\n//               selectedFlight ? (\n//                 <BookingForm \n//                   flight={selectedFlight}\n//                   user={user}\n//                   onBook={handleBookFlight}\n//                 />\n//               ) : (\n//                 <Navigate to=\"/\" />\n//               )\n//             } />\n            \n//             <Route path=\"/wallet\" element={\n//               <Wallet \n//                 user={user}\n//                 onAddFunds={handleAddFunds}\n//               />\n//             } />\n            \n//             <Route path=\"/history\" element={\n//               <BookingHistory \n//                 bookings={bookings}\n//                 onDownloadTicket={(pnr) => {\n//                   window.open(`http://localhost:5001/api/bookings/ticket/${pnr}`, '_blank');\n//                 }}\n//               />\n//             } />\n//           </Routes>\n//         </div>\n        \n//         <footer className=\"bg-purple-900 text-white py-8 mt-12\">\n//           <div className=\"container mx-auto px-4 text-center\">\n//             <p className=\"text-purple-200\">© 2024 Flight Booking System. All rights reserved.</p>\n//             <p className=\"text-purple-300 mt-2\">Built with ❤️ using MERN Stack</p>\n//           </div>\n//         </footer>\n//       </div>\n//     </Router>\n//   );\n// };\n\n// export default App;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}