{"ast":null,"code":"// import React, { useState, useEffect } from 'react';\n// import { Routes, Route, Navigate, useNavigate } from 'react-router-dom';\n// import axios from 'axios';\n// import { Toaster, toast } from 'react-hot-toast';\n// import Navbar from './components/Navbar';\n// import FlightSearch from './components/FlightSearch';\n// import FlightList from './components/FlightList';\n// import BookingForm from './components/BookingForm';\n// import Wallet from './components/Wallet';\n// import BookingHistory from './components/BookingHistory';\n// import BookingSuccess from './components/BookingSuccess';\n// import './styles/purple-theme.css';\n// const API_BASE = 'http://localhost:5001/api';\n\n// const App = () => {\n//   const [user, setUser] = useState(null);\n//   const [flights, setFlights] = useState([]);\n//   const [selectedFlight, setSelectedFlight] = useState(null);\n//   const [bookings, setBookings] = useState([]);\n//   const navigate = useNavigate();\n//   /* =========================\n//      INIT USER (NO HARDCODING)\n//      ========================= */\n//   useEffect(() => {\n//     const initUser = async () => {\n//       try {\n//         const savedUser = localStorage.getItem('flightUser');\n//         if (savedUser) {\n//           setUser(JSON.parse(savedUser));\n//           return;\n//         }\n\n//         // Auto-create or fetch user from DB\n//         const res = await axios.post(`${API_BASE}/users/init`, {\n//           name: 'John Doe',\n//           email: 'john@example.com'\n//         });\n\n//         const newUser = {\n//           id: res.data._id,\n//           name: res.data.name,\n//           email: res.data.email,\n//           walletBalance: res.data.wallet_balance\n//         };\n\n//         localStorage.setItem('flightUser', JSON.stringify(newUser));\n//         setUser(newUser);\n//       } catch (err) {\n//         console.error('User init failed:', err);\n//         toast.error('Failed to initialize user');\n//       }\n//     };\n\n//     initUser();\n//   }, []);\n\n//   /* =========================\n//      FETCH BOOKINGS\n//      ========================= */\n//   useEffect(() => {\n//     if (!user?.id) return;\n\n//     const fetchBookings = async () => {\n//       try {\n//         const res = await axios.get(\n//           `${API_BASE}/bookings/user/${user.id}`\n//         );\n//         setBookings(res.data);\n//       } catch (err) {\n//         console.error('Fetch bookings failed:', err);\n//       }\n//     };\n\n//     fetchBookings();\n//   }, [user]);\n\n//   /* =========================\n//      SEARCH FLIGHTS\n//      ========================= */\n//   const handleSearchFlights = async (searchParams) => {\n//     try {\n//       const res = await axios.get(`${API_BASE}/flights/search`, {\n//         params: searchParams\n//       });\n//       setFlights(res.data);\n//       toast.success(`Found ${res.data.length} flights`);\n//     } catch {\n//       toast.error('Error searching flights');\n//     }\n//   };\n\n//   /* =========================\n//      BOOKING ATTEMPT (SURGE)\n//      ========================= */\n//   const handleBookingAttempt = async (flightId) => {\n//     try {\n//       const res = await axios.post(\n//         `${API_BASE}/flights/${flightId}/attempt`,\n//         { userId: user.id }\n//       );\n\n//       setFlights(prev =>\n//         prev.map(f =>\n//           f.flight_id === flightId\n//             ? { ...f, current_price: res.data.current_price }\n//             : f\n//         )\n//       );\n\n//       if (res.data.surge_active) {\n//         toast.error('‚ö†Ô∏è Surge pricing applied!', { duration: 4000 });\n//       }\n\n//       return res.data;\n//     } catch (err) {\n//       console.error('Booking attempt error:', err);\n//       return null;\n//     }\n//   };\n\n//   const handleBookFlight = async (flightId, passengerInfo) => {\n//     try {\n//       const res = await axios.post(`${API_BASE}/bookings`, {\n//         userId: user.id,\n//         flightId,\n//         passengerInfo\n//       });\n\n//       if (!res.data.success) return false;\n\n//       // Update wallet\n//       const updatedUser = {\n//         ...user,\n//         walletBalance: res.data.new_balance\n//       };\n\n//       setUser(updatedUser);\n//       localStorage.setItem('flightUser', JSON.stringify(updatedUser));\n\n//       // Update bookings\n//       setBookings(prev => [res.data.booking, ...prev]);\n\n//       // üöÄ Navigate AFTER returning true\n//       setTimeout(() => {\n//         navigate('/success', { state: { booking: res.data.booking } });\n//       }, 0);\n\n//       return true; // üî• THIS WAS MISSING / INCONSISTENT\n//     } catch (err) {\n//       console.error(err);\n//       toast.error(err.response?.data?.error || 'Booking failed');\n//       return false;\n//     }\n//   };\n\n//   /* =========================\n//      ADD WALLET FUNDS\n//      ========================= */\n//   const handleAddFunds = async (amount) => {\n//     try {\n//       const res = await axios.post(\n//         `${API_BASE}/wallet/${user.id}/add`,\n//         { amount }\n//       );\n\n//       const updatedUser = {\n//         ...user,\n//         walletBalance: res.data.new_balance\n//       };\n\n//       setUser(updatedUser);\n//       localStorage.setItem('flightUser', JSON.stringify(updatedUser));\n\n//       toast.success(`‚Çπ${amount} added to wallet`);\n//       return true;\n//     } catch {\n//       toast.error('Failed to add funds');\n//       return false;\n//     }\n//   };\n\n//   /* =========================\n//      LOADING STATE\n//      ========================= */\n//   if (!user) {\n//     return (\n//       <div className=\"text-center mt-24 text-purple-600 text-lg\">\n//         Initializing user...\n//       </div>\n//     );\n//   }\n\n//   /* =========================\n//      UI\n//      ========================= */\n//   return (\n//     <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50\">\n//       <Toaster\n//         position=\"top-right\"\n//         toastOptions={{\n//           style: {\n//             background: '#6B46C1',\n//             color: '#fff'\n//           }\n//         }}\n//       />\n\n//       <Navbar user={user} />\n\n//       <div className=\"container mx-auto px-4 py-8\">\n//         <Routes>\n//             <Route\n//               path=\"/\"\n//               element={\n//                 <>\n//                   <div className=\"text-center mb-12\">\n//                     <h1 className=\"text-4xl font-bold text-purple-900 mb-4\">\n//                       ‚úàÔ∏è Find Your Perfect Flight\n//                     </h1>\n//                     <p className=\"text-purple-600 text-lg\">\n//                       Dynamic pricing ‚Ä¢ Wallet payments ‚Ä¢ Instant tickets\n//                     </p>\n//                   </div>\n\n//                   <FlightSearch onSearch={handleSearchFlights} />\n\n//                   {flights.length > 0 && (\n//                     <FlightList\n//                       flights={flights}\n//                       onSelectFlight={setSelectedFlight}\n//                       onBookingAttempt={handleBookingAttempt}\n//                     />\n//                   )}\n//                 </>\n//               }\n//             />\n\n//             <Route\n//               path=\"/book\"\n//               element={\n//                 selectedFlight ? (\n//                   <BookingForm\n//                     flight={selectedFlight}\n//                     user={user}\n//                     onBook={handleBookFlight}\n//                   />\n//                 ) : (\n//                   <Navigate to=\"/\" />\n//                 )\n//               }\n//             />\n//             <Route path=\"/success\" element={<BookingSuccess />} />\n//             <Route\n//               path=\"/wallet\"\n//               element={\n//                 <Wallet user={user} onAddFunds={handleAddFunds} />\n//               }\n//             />\n\n//             <Route\n//               path=\"/history\"\n//               element={\n//                 <BookingHistory\n//                   bookings={bookings}\n//                   onDownloadTicket={(pnr) =>\n//                     window.open(\n//                       `${API_BASE}/bookings/ticket/${pnr}`,\n//                       '_blank'\n//                     )\n//                   }\n//                 />\n//               }\n//             />\n//           </Routes>\n\n//       </div>\n\n//       <footer className=\"bg-purple-900 text-white py-8 mt-12\">\n//         <div className=\"container mx-auto text-center\">\n//           {/* */}\n//           <p className=\"text-purple-300 mt-1\">\n//             Built with ‚ù§Ô∏è by Tanya\n//           </p>\n//         </div>\n//       </footer>\n//     </div>\n//   );\n// };\n\n// export default App;","map":{"version":3,"names":[],"sources":["/Users/tanyakumari/Desktop/flight-booking-app/frontend/src/App.js"],"sourcesContent":["// import React, { useState, useEffect } from 'react';\n// import { Routes, Route, Navigate, useNavigate } from 'react-router-dom';\n// import axios from 'axios';\n// import { Toaster, toast } from 'react-hot-toast';\n// import Navbar from './components/Navbar';\n// import FlightSearch from './components/FlightSearch';\n// import FlightList from './components/FlightList';\n// import BookingForm from './components/BookingForm';\n// import Wallet from './components/Wallet';\n// import BookingHistory from './components/BookingHistory';\n// import BookingSuccess from './components/BookingSuccess';\n// import './styles/purple-theme.css';\n// const API_BASE = 'http://localhost:5001/api';\n\n// const App = () => {\n//   const [user, setUser] = useState(null);\n//   const [flights, setFlights] = useState([]);\n//   const [selectedFlight, setSelectedFlight] = useState(null);\n//   const [bookings, setBookings] = useState([]);\n//   const navigate = useNavigate();\n//   /* =========================\n//      INIT USER (NO HARDCODING)\n//      ========================= */\n//   useEffect(() => {\n//     const initUser = async () => {\n//       try {\n//         const savedUser = localStorage.getItem('flightUser');\n//         if (savedUser) {\n//           setUser(JSON.parse(savedUser));\n//           return;\n//         }\n\n//         // Auto-create or fetch user from DB\n//         const res = await axios.post(`${API_BASE}/users/init`, {\n//           name: 'John Doe',\n//           email: 'john@example.com'\n//         });\n\n//         const newUser = {\n//           id: res.data._id,\n//           name: res.data.name,\n//           email: res.data.email,\n//           walletBalance: res.data.wallet_balance\n//         };\n\n//         localStorage.setItem('flightUser', JSON.stringify(newUser));\n//         setUser(newUser);\n//       } catch (err) {\n//         console.error('User init failed:', err);\n//         toast.error('Failed to initialize user');\n//       }\n//     };\n\n//     initUser();\n//   }, []);\n\n//   /* =========================\n//      FETCH BOOKINGS\n//      ========================= */\n//   useEffect(() => {\n//     if (!user?.id) return;\n\n//     const fetchBookings = async () => {\n//       try {\n//         const res = await axios.get(\n//           `${API_BASE}/bookings/user/${user.id}`\n//         );\n//         setBookings(res.data);\n//       } catch (err) {\n//         console.error('Fetch bookings failed:', err);\n//       }\n//     };\n\n//     fetchBookings();\n//   }, [user]);\n\n//   /* =========================\n//      SEARCH FLIGHTS\n//      ========================= */\n//   const handleSearchFlights = async (searchParams) => {\n//     try {\n//       const res = await axios.get(`${API_BASE}/flights/search`, {\n//         params: searchParams\n//       });\n//       setFlights(res.data);\n//       toast.success(`Found ${res.data.length} flights`);\n//     } catch {\n//       toast.error('Error searching flights');\n//     }\n//   };\n\n//   /* =========================\n//      BOOKING ATTEMPT (SURGE)\n//      ========================= */\n//   const handleBookingAttempt = async (flightId) => {\n//     try {\n//       const res = await axios.post(\n//         `${API_BASE}/flights/${flightId}/attempt`,\n//         { userId: user.id }\n//       );\n\n//       setFlights(prev =>\n//         prev.map(f =>\n//           f.flight_id === flightId\n//             ? { ...f, current_price: res.data.current_price }\n//             : f\n//         )\n//       );\n\n//       if (res.data.surge_active) {\n//         toast.error('‚ö†Ô∏è Surge pricing applied!', { duration: 4000 });\n//       }\n\n//       return res.data;\n//     } catch (err) {\n//       console.error('Booking attempt error:', err);\n//       return null;\n//     }\n//   };\n\n//   const handleBookFlight = async (flightId, passengerInfo) => {\n//     try {\n//       const res = await axios.post(`${API_BASE}/bookings`, {\n//         userId: user.id,\n//         flightId,\n//         passengerInfo\n//       });\n\n//       if (!res.data.success) return false;\n\n//       // Update wallet\n//       const updatedUser = {\n//         ...user,\n//         walletBalance: res.data.new_balance\n//       };\n\n//       setUser(updatedUser);\n//       localStorage.setItem('flightUser', JSON.stringify(updatedUser));\n\n//       // Update bookings\n//       setBookings(prev => [res.data.booking, ...prev]);\n\n//       // üöÄ Navigate AFTER returning true\n//       setTimeout(() => {\n//         navigate('/success', { state: { booking: res.data.booking } });\n//       }, 0);\n\n//       return true; // üî• THIS WAS MISSING / INCONSISTENT\n//     } catch (err) {\n//       console.error(err);\n//       toast.error(err.response?.data?.error || 'Booking failed');\n//       return false;\n//     }\n//   };\n\n//   /* =========================\n//      ADD WALLET FUNDS\n//      ========================= */\n//   const handleAddFunds = async (amount) => {\n//     try {\n//       const res = await axios.post(\n//         `${API_BASE}/wallet/${user.id}/add`,\n//         { amount }\n//       );\n\n//       const updatedUser = {\n//         ...user,\n//         walletBalance: res.data.new_balance\n//       };\n\n//       setUser(updatedUser);\n//       localStorage.setItem('flightUser', JSON.stringify(updatedUser));\n\n//       toast.success(`‚Çπ${amount} added to wallet`);\n//       return true;\n//     } catch {\n//       toast.error('Failed to add funds');\n//       return false;\n//     }\n//   };\n\n//   /* =========================\n//      LOADING STATE\n//      ========================= */\n//   if (!user) {\n//     return (\n//       <div className=\"text-center mt-24 text-purple-600 text-lg\">\n//         Initializing user...\n//       </div>\n//     );\n//   }\n\n//   /* =========================\n//      UI\n//      ========================= */\n//   return (\n//     <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50\">\n//       <Toaster\n//         position=\"top-right\"\n//         toastOptions={{\n//           style: {\n//             background: '#6B46C1',\n//             color: '#fff'\n//           }\n//         }}\n//       />\n\n//       <Navbar user={user} />\n\n//       <div className=\"container mx-auto px-4 py-8\">\n//         <Routes>\n//             <Route\n//               path=\"/\"\n//               element={\n//                 <>\n//                   <div className=\"text-center mb-12\">\n//                     <h1 className=\"text-4xl font-bold text-purple-900 mb-4\">\n//                       ‚úàÔ∏è Find Your Perfect Flight\n//                     </h1>\n//                     <p className=\"text-purple-600 text-lg\">\n//                       Dynamic pricing ‚Ä¢ Wallet payments ‚Ä¢ Instant tickets\n//                     </p>\n//                   </div>\n\n//                   <FlightSearch onSearch={handleSearchFlights} />\n\n//                   {flights.length > 0 && (\n//                     <FlightList\n//                       flights={flights}\n//                       onSelectFlight={setSelectedFlight}\n//                       onBookingAttempt={handleBookingAttempt}\n//                     />\n//                   )}\n//                 </>\n//               }\n//             />\n\n//             <Route\n//               path=\"/book\"\n//               element={\n//                 selectedFlight ? (\n//                   <BookingForm\n//                     flight={selectedFlight}\n//                     user={user}\n//                     onBook={handleBookFlight}\n//                   />\n//                 ) : (\n//                   <Navigate to=\"/\" />\n//                 )\n//               }\n//             />\n//             <Route path=\"/success\" element={<BookingSuccess />} />\n//             <Route\n//               path=\"/wallet\"\n//               element={\n//                 <Wallet user={user} onAddFunds={handleAddFunds} />\n//               }\n//             />\n\n//             <Route\n//               path=\"/history\"\n//               element={\n//                 <BookingHistory\n//                   bookings={bookings}\n//                   onDownloadTicket={(pnr) =>\n//                     window.open(\n//                       `${API_BASE}/bookings/ticket/${pnr}`,\n//                       '_blank'\n//                     )\n//                   }\n//                 />\n//               }\n//             />\n//           </Routes>\n\n//       </div>\n\n//       <footer className=\"bg-purple-900 text-white py-8 mt-12\">\n//         <div className=\"container mx-auto text-center\">\n//           {/* */}\n//           <p className=\"text-purple-300 mt-1\">\n//             Built with ‚ù§Ô∏è by Tanya\n//           </p>\n//         </div>\n//       </footer>\n//     </div>\n//   );\n// };\n\n// export default App;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}